language: java
jdk:
- oraclejdk8
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
- pip
- directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
script: "./gradlew -iS build -x test"
env:
  global:
    - secure: "ZtI5z9uZ9PKa/0zAzIabwQK6vXAwFjXNK3uyDmXBZGV33xpf78bqPs7G9mjWbZ2vldoMpT54+uph0kaFDo6sHEQ/7Cssb6trkdKZhvIO1kYjbzDNl/Og5p5QErQBsUye//VJYzBxdNIh9tWvGhQP3zVlF6aNc68Z44ix1V57EVImt4p79vZCjnWlZqdsYBG6c/aoVoY6XoqC4HZJeDaQqjCx4ycJ9UpMIte7RGuTL2bb6deaF6kVyhLd37JZkT2/AJyKwUx485KQ4C+EwWelgl/9yrb0H3nmvNHoGW05wtoov01ONwhECA+smNv9jnuKl4+E4bYuvXGrkdWIPKZ0UvTGYr+IJub2/AToNiVQzHJ63ul/zYAi2ULbi5QIvLHuNtI+cz3BaAlCATCl7Gxdl1ZhL5QYC3oJwzodfUam2J692qnFEdajbDQQGiciNxt5zsRzwQglo0uWeKVnzG9vsyEui36k1i0HoLFuEyNJQeqiNEPd0aZVX0gqe3qhlNlunQrUG3AEDs/pta/UyCMHIpX2JEwYjT5gZOTdDGivYmo6l2yseV9+PfOTLskbbpPPXzE9fFi4pUa7uyHW2/tJdj9jNZRDJL8lS6Afq8yuakxLk6x46N2Bry6fJE2BW+2sDHJTudlcj5A0DNJdc2/vvZ1rntmIvQwp+BXQKnndMcU="
before_deploy:
- pip install --user awscli
deploy:
- provider: s3
  skip_cleanup: true
  region: eu-west-1
  bucket: devternity-code
  local_dir: build/distributions
  acl: public_read
after_deploy:
  - aws lambda update-function-code --function-name devternity_ticket_generator --s3-bucket devternity-code --s3-key ticket-generator.zip
notifications:
  slack:
    secure: dLLFxOFL3Lvb6BiTIM4UYxrrGSARmkq0eTxVyg+QTwLCed+s7vAINSihyCcKF0emthEbUsVHPI5HXYevhf93GTV045Xh/Kf46GXRDZXZeKDQkSbgAkfSVwjFdeQc2tSxk9OVNbQcDh78WkxFuZwS6riqi9pzHnKag/UjrnW0iWAhZwROq22ZTyq2H9TlRHnolJCwr8jRVbxaornetc27nJtGZMIB4S0H0khUfP8u3WNZ2J47jet2AVwR6A7EUYJ8MKyUs+PLrNc+adXfW0ZlREuo2XkKzlzQyvqlZTF+/naJ3/JPZRet2T3CgNiSuEBAtvnfgpHP71SCPvphq7CXLC6OgbfRCBgo4J7TgXICalfaQDH3tzqSFaNRalT/X/B04WgFlPh/8UJ6QDkFroATxgkW8aQkQo3L3apvO7+xAiE+tftTwANjEutYkgdz4CwKwBYTnSik+0FNK4qm6czlrnl9ob4eEOxq+kcXhLFZvtO8w5TVhZaO2SIq9S46mfBWnS+9+pfQe/XLL19PqnPrbDbpLuPS/bLy6sCTL3Va1exTLk3gVRBtmFMIkRMP2CaTgYw7aqLVnOotneIS4qIT7lxqs4KNELHGMRXrYgjhMMRiGQeUq+bSCwHncSgYD1+Ey2PT8rM3tWIiF86XWdompyiYKNzJgt8GpJd9cSGdAzA=
